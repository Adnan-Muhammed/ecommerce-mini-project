
<%-include('header')-%>


<style>
    canvas{
        width:500px
    }
</style>



            <!-- Sale & Revenue Start -->
            <div class="container-fluid pt-4 px-4">
                <div class="row g-4">
                    <div class="col-sm-6 col-xl-3">
                        <div class="bg-light rounded d-flex align-items-center justify-content-between p-4">
                            <i class="fa fa-chart-line fa-3x text-primary"></i>
                            <div class="ms-3">
                                <p class="mb-2">Total Sales Count </p>
                                <%if(locals.totalOrder){%>
                                    <h6 class="mb-0"><%=totalOrder%></h6>
                                <%}else{%>
                                    <h6 class="mb-0">No Sales</h6>
                                <%}%>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-xl-3">
                        <div class="bg-light rounded d-flex align-items-center justify-content-between p-4">
                            <i class="fa fa-chart-bar fa-3x text-primary"></i>
                            <div class="ms-3">
                                <p class="mb-2">Total Sales Amount</p>
                                <%if(locals.totalAmount){%>
                                    <h6 class="mb-0">₹<%=totalAmount%></h6>
                                <%}else{%>
                                    <h6 class="mb-0">No Sales</h6>
                                <%}%>                            
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-xl-3">
                        <div class="bg-light rounded d-flex align-items-center justify-content-between p-4">
                            <i class="fa fa-chart-area fa-3x text-primary"></i>
                            <div class="ms-3">
                                <p class="mb-2">Overall discount</p>
                                <%if(locals.totalDiscount){%>
                                    <h6 class="mb-0">₹<%=totalDiscount%></h6>
                                <%}else{%>
                                    <h6 class="mb-0">No Discounts</h6>
                                <%}%>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-xl-3">
                        <div class="bg-light rounded d-flex align-items-center justify-content-between p-4">
                            <i class="fa fa-chart-pie fa-3x text-primary"></i>
                            <div class="ms-3">
                                <p class="mb-2">Coupon deduction</p>
                                <%if(locals.couponDiscount){%>
                                    <h6 class="mb-0">₹<%=couponDiscount%></h6>
                                <%}else{%>
                                    <h6 class="mb-0">No CouponDeduction</h6>
                                <%}%>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
            <!-- Sale & Revenue End -->








            <!-- Sales Chart Start -->
            <div class="container-fluid pt-4 px-4">
                <div class="row g-4">
                        



                    <div class="col-sm-12 col-xl-6">
                        <div class="bg-light rounded h-100 p-4">

                            <div class=" pb-2 mb-4" >

                                <h6>Select Filter</h6>

                                <select id="sales-filter">
                                    <option value="yearly">Yearly</option>
                                    <option value="monthly">Monthly</option>
                                </select>
                            </div>

                            <canvas id="monthly-yearly-sales-chart" height="200"></canvas>
                        </div>
                    </div>
                    <div class="col-sm-12 col-xl-6">
                        <div class="bg-light rounded h-100 p-4">
                            <div class=" pb-2 mb-4" >
                                <h6>top- category</h6>
                                
                            </div>
                            <canvas id="best-selling-category" ></canvas>
                        </div>
                    </div>
                    <div class="col-sm-12 col-xl-6">
                        <div class="bg-light rounded h-100 p-4">
                            <div class=" pb-2 mb-4"   >
                                <h6>top-product</h6>

                            </div>
                            <canvas id="best-selling-product" ></canvas>
                        </div>
                    </div>
                    <div class="col-sm-12 col-xl-6">
                        <div class="bg-light rounded h-100 p-4">
                            <h6 class="mb-4">Multiple Bar Chart</h6>
                            <canvas id="" ></canvas>
                        </div>
                    </div>
                </div>
            </div>




            <!-- Sales Chart End -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

            <br>




            <!-- Recent Sales Start -->



            <!-- <div class="bg-light rounded h-100 p-4"> -->
                <h6 class="mb-4">Sales Report</h6>
                
                <div class="table-responsive">
                    <table id="salesTable" class="table table-bordered">
                        <thead>
                            <tr class="text-dark">
                                <th rowspan="2"></th> <!-- Add a column for checkbox input -->
                                <th rowspan="2">User Name</th>
                                <th rowspan="2">Order Date</th>
                                <th rowspan="2">Grand Total</th>
                                <th rowspan="2">Payment Status &<br>Order Status</th>
                                <th rowspan="2">Coupon</th>
                                <th rowspan="2">Tax</th>
                                <th style="text-align: center;" colspan="7">Order Items</th>
                                <th rowspan="2">Action</th>
                            </tr>
                            <tr class="text-dark">
                                <!-- Other headers -->
                                <th>Product Name</th>
                                <th>Unit Price</th>
                                <th>Quantity</th>
                                <th>Product Price</th>
                                <th>Category Offer</th>
                                <th>Product Offer</th>
                                <th>Total Price</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Iterate over orders and order items -->
                            <% orders.forEach(order => { %>
                                <% order.orderItems.forEach((item, index) => { %>
                                    <tr class="text-dark">
                                        <!-- Checkbox input for each row -->
                                        <!-- Render order details -->
                                        <% if (index === 0) { %>
                                            <td rowspan="<%= order.orderItems.length %>"><input type="checkbox"></td>
                                            <td rowspan="<%= order.orderItems.length %>"><%= order.userName %></td>
                                            <td rowspan="<%= order.orderItems.length %>"><%= new Date(order.orderDate).toLocaleString('en-US', { weekday: 'short', day: 'numeric', month: 'short', year: 'numeric', hour: 'numeric', minute: 'numeric', second: 'numeric', hour12: true }) %></td>
                                            <td rowspan="<%= order.orderItems.length %>"><%= order.grandTotal %></td>
                                            <td rowspan="<%= order.orderItems.length %>">
                                                <%= order.paymentStatus.type %>
                                                <br>
                                                <%= order.orderStatus.type %>
                                            </td>
                                            <td rowspan="<%= order.orderItems.length %>">
                                                <% if(order.couponName){ %>
                                                    <%= order.couponName %>
                                                    <br>
                                                    <%= order.couponDiscountPercentage %> %
                                                    <br>
                                                    <%= order.couponDiscount %>
                                                <% }else{ %>
                                                    N/A
                                                <% } %>
                                            </td>
                                            <td rowspan="<%= order.orderItems.length %>"><%= order.tax %></td>
                                        <% } %>
                                        <!-- Render order item details -->
                                        <td><%= item.productName %></td>
                                        <td><%= item.unitPrice %></td>
                                        <td><%= item.quantity %></td>
                                        <td><%= item.price %></td>
                                        <td>
                                            <%= item.categoryDiscountPecentage %>%
                                            <br>
                                            <%= item.categoryOffer %>
                                        </td>
                                        <td>
                                            <%= item.productDiscountPercentage %>%
                                            <br>
                                            <%= item.productOffer %>
                                        </td>
                                        <td><%= item.totalPrice %></td>
                                        <!-- Render action -->
                                        <% if (index === 0) { %>
                                            <td rowspan="<%= order.orderItems.length %>"><a class="btn btn-sm btn-primary" href="">Download</a></td>
                                        <% } %>
                                    </tr>
                                <% }); %>
                            <% }); %>
                        </tbody>
                    </table>
                </div>
            <!-- </div> -->



















        </div>
        <!-- Content End -->


        <!-- Back to Top -->






<script>
    document.addEventListener('DOMContentLoaded', function() {
        var ctx = document.getElementById('monthly-yearly-sales-chart').getContext('2d');
        var monthlyData = {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            datasets: [{
                label: 'Monthly Sales',
                data: [5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60],
                // backgroundColor: 'rgba(0, 156, 255, .7)'
                backgroundColor: '#33FF57'
                 
            }]
        };
        var yearlyData = {
            labels: ['2020', '2021', '2022', '2023', '2024'],
            datasets: [{
                label: 'Yearly Sales',
                data: [150, 180, 220, 250, 280],
                backgroundColor: '#FF5733'
            }]
        };


        
        var chart = new Chart(ctx, {
            type: 'bar',
            data: monthlyData,
            options: {
                responsive: true,
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });


        document.getElementById('sales-filter').addEventListener('change', function() {
            var filter = this.value;
            if (filter === 'yearly') {
                chart.data = yearlyData;
            } else if (filter === 'monthly') {
                chart.data = monthlyData;
            }
            chart.update();
        });
    });
</script>







        


<script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log(123);
        var ctx = document.getElementById('best-selling-category').getContext('2d');
        var salesData = {
            labels: ['Category A', 'Category B', 'Category C', 'Category D', 'Category E'],
            datasets: [{
                label: 'top category',
                data: [100, 80, 120, 90, 110],
                backgroundColor: '#5B33FF'
            },
            ]
        };
    
        var chart = new Chart(ctx, {
            type: 'bar',
            data: salesData,
            options: {
                responsive: true,
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
    });
    </script>
    
    
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        var ctx = document.getElementById('monthly-yearly-best-selling-product').getContext('2d');
        
        // Sample data for 10 products
        var monthlyData = {
            labels: ['Product 1', 'Product 2', 'Product 3', 'Product 4', 'Product 5', 'Product 6', 'Product 7', 'Product 8', 'Product 9', 'Product 10'],
            datasets: [{
                label: 'Monthly Sales',
                data: [100, 80, 120, 90, 110, 70, 130, 95, 105, 115], // Monthly sales data for each product
                // backgroundColor: 'rgba(0, 156, 255, .7)'
                backgroundColor: '#FFD633'
            }]
        };
        var yearlyData = {
            labels: ['Product 1', 'Product 2', 'Product 3', 'Product 4', 'Product 5', 'Product 6', 'Product 7', 'Product 8', 'Product 9', 'Product 10'],
            datasets: [{
                label: 'Yearly Sales',
                data: [1000, 800, 1200, 900, 1100, 700, 1300, 950, 1050, 1150], // Yearly sales data for each product
                // backgroundColor: 'rgba(255, 99, 132, 0.7)'
                backgroundColor: '#33FFC6'
            }]
        };
    
        var chart = new Chart(ctx, {
            type: 'bar',
            data: monthlyData,
            options: {
                responsive: true,
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
    
        document.getElementById('top-product-filter').addEventListener('change', function() {
            var filter = this.value;
            if (filter === 'yearly') {
                chart.data = yearlyData;
            } else if (filter === 'monthly') {
                chart.data = monthlyData;
            }
            chart.update();
        });
    });
    </script>
    

        <%-include('footer')-%>


      