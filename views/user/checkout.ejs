<%-include('header')-%>

<div id="page-content">
    <!--Page Title-->
    <div class="page section-header text-center">
        <div class="page-title">
            <div class="wrapper"><h1 class="page-width">Checkout</h1></div>
          </div>
    </div>
    <!--End Page Title-->
    
    <div class="container">
        

        <div class="row billing-fields">
            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 sm-margin-30px-bottom">
                <div class="create-ac-content bg-light-gray padding-20px-all">
                    <div class="customer-box customer-coupon">
                        <h3 class="font-15 xs-font-13"><i class=""></i>  <a href="#your-address" class="text-white text-decoration-underline" data-toggle="collapse">Your Address</a></h3>
                        <h3 class="font-15 xs-font-13"><i class=""></i>  <a href="#add-address" class="text-white text-decoration-underline" data-toggle="collapse">Add Address</a></h3>

                        <div id="add-address" class="collapse coupon-checkout-content">
                            <div class="discount-coupon">


                                <form  id="address-form" action="/address-added" method="POST">
                                        <h2 class="login-title mb-3">Billing details</h2>
                                        <div class="row">
                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-firstname">First Name <span class="required-f">*</span></label>
                                                <input name="firstname" value="" id="input-firstname" type="text">
                                                <div class="error" style="color: red;"></div>


                                            </div>
                                           
                                        </div>
                                        <div class="row">

                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-telephone">Telephone <span class="required-f">*</span></label>
                                                <input name="telephone" value="" id="input-telephone" type="tel">
                                                <div class="error" style="color: red;"></div>

                                            </div>


                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-email">E-Mail <span class="required-f">*</span></label>
                                                <input name="email" value="" id="input-email" type="email">
                                                <div class="error" style="color: red;"></div>

                                            </div>                    
                                        </div>
            
                                        <div class="row">
                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-address-1">Address <span class="required-f">*</span></label>
                                                <input name="address_1" value="" id="input-address-1" type="text">
                                                <div class="error" style="color: red;"></div>

                                            </div>

                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-city">City <span class="required-f">*</span></label>
                                                <input name="city" value="" id="input-city" type="text">
                                                <div class="error" style="color: red;"></div>

                                            </div>

                                        </div>
                                       
                                        <div class="row">
                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-postcode">Post Code <span class="required-f">*</span></label>
                                                <input name="postcode" value="" id="input-postcode" type="text">
                                                <div class="error" style="color: red;"></div>

                                            </div>

                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-zone">Region / State <span class="required-f">*</span></label>
                                                <input name="state" value="" id="input-state" type="text">
                                                <div class="error" style="color: red;"></div>

                                            </div>
                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <button class="btn" style="background-color: cadetblue;" type="submit">Submit</button>
                                            </div>
                                        </div>

                                </form> 
                            </div>
                        </div>




                        <div id="your-address" class="collapse coupon-checkout-content">
                            <div class="discount-coupon">
                                        <h2 class="login-title mb-3">Billing details</h2>
                                        <div class="row">
                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-firstname">First Name <span class="required-f">*</span></label>
                                                <input name="firstname" value="" id="input-firstname" type="text">
                                            </div>
                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-lastname">Last Name <span class="required-f">*</span></label>
                                                <input name="lastname" value="" id="input-lastname" type="text">
                                            </div>
                                        </div>
                                        <div class="row">

                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-telephone">Telephone <span class="required-f">*</span></label>
                                                <input name="telephone" value="" id="input-telephone" type="tel">
                                            </div>


                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-email">E-Mail <span class="required-f">*</span></label>
                                                <input name="email" value="" id="input-email" type="email">
                                            </div>                    
                                        </div>
            
                                        <div class="row">
                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-address-1">Address <span class="required-f">*</span></label>
                                                <input name="address_1" value="" id="input-address-1" type="text">
                                            </div>

                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-city">City <span class="required-f">*</span></label>
                                                <input name="city" value="" id="input-city" type="text">
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-postcode">Post Code <span class="required-f">*</span></label>
                                                <input name="postcode" value="" id="input-postcode" type="text">
                                            </div>

                                            <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                <label for="input-zone">Region / State <span class="required-f">*</span></label>
                                                <input name="stateName" value="Kerala" id="state-name" type="text">
                                            </div>
                                           
                                        </div>
                            </div>
                        </div>



                        
                    </div>


                   


                </div>
            </div>

            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12">
                <div class="your-order-payment">
                    <div class="your-order">
                        <h2 class="order-title mb-4">Your Order</h2>



                        <div class="table-responsive-sm order-table"> 
                            <table class="bg-white table table-bordered table-hover text-center">
                                <thead>
                                    <tr>
                                        <th class="text-left">Product Name</th>
                                        <th>Price</th>
                                        <th>Qty</th>
                                        <th>Subtotal</th>
                                    </tr>
                                </thead>
                                <% locals.cartItems.forEach(item => { %>

                                <tbody class="font-weight-600" >
                                    <tr>
                                        <td class="text-left">  <%= item.name %>   </td>
                                        <td>$<%= item.unitPrice %></td>
                                        <td><%=item.quantity%></td>
                                        <td>$<%= item.price %></td>
                                    </tr>
                                    
                                </tbody>
                        <% }); %>

                                <tfoot class="font-weight-600">
                                    <tr>
                                        <td colspan="3" class="text-right">Shipping </td>
                                        <td>FREE</td>
                                    </tr>
                                    <tr>
                                        <td colspan="3" class="text-right">Tax </td>
                                        <td>$<%= tax.toFixed(2)%> </td>
                                    </tr>
                                    <tr>
                                        <td colspan="3" class="text-right">Grand Total</td>
                                        <td>$<%= grandTotal.toFixed(2) %></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>


                        
                    </div>
                    
                    <hr />

                    <div class="your-payment">
                        <h2 class="payment-title mb-3">payment method</h2>
                        <div class="payment-method">
                            <div class="payment-accordion">
                                <div id="accordion" class="payment-section">



                                    <!-- <div class="card mb-2">
                                        <div class="card-header">
                                            <a class="card-link" data-toggle="collapse" href="#collapseOne">Direct Bank Transfer </a>
                                        </div>
                                        <div id="collapseOne" class="collapse" data-parent="#accordion">
                                            <div class="card-body">
                                                <p class="no-margin font-15">Make your payment directly into our bank account. Please use your Order ID as the payment reference. Your order won't be shipped until the funds have cleared in our account.</p>
                                            </div>
                                        </div>
                                    </div> -->


                                    <!-- <div class="card mb-2">
                                        <div class="card-header">
                                            <a class="collapsed card-link" data-toggle="collapse" href="#collapseTwo">Cheque Payment</a>
                                        </div>
                                        <div id="collapseTwo" class="collapse" data-parent="#accordion">
                                            <div class="card-body">
                                                <p class="no-margin font-15">Please send your cheque to Store Name, Store Street, Store Town, Store State / County, Store Postcode.</p>
                                            </div>
                                        </div>
                                    </div> -->



                                    <div class="card margin-15px-bottom border-radius-none">
                                        <div class="card-header">
                                            <a class="collapsed card-link" data-toggle="collapse" href="#collapseThree"> Cash On Delivery </a>
                                        </div>
                                        <!-- <div id="collapseThree" class="collapse" data-parent="#accordion">
                                            <div class="card-body">
                                                <p class="no-margin font-15">Pay via PayPal; you can pay with your credit card if you don't have a PayPal account.</p>
                                            </div>
                                        </div> -->
                                    </div>


                                    <!-- <div class="card mb-2">
                                        <div class="card-header">
                                            <a class="collapsed card-link" data-toggle="collapse" href="#collapseFour"> Payment Information </a>
                                        </div>
                                        <div id="collapseFour" class="collapse" data-parent="#accordion">
                                            <div class="card-body">
                                                <fieldset>
                                                    <div class="row">
                                                        <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                            <label for="input-cardname">Name on Card <span class="required-f">*</span></label>
                                                            <input name="cardname" value="" placeholder="Card Name" id="input-cardname" class="form-control" type="text">
                                                        </div>
                                                        <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                            <label for="input-country">Credit Card Type <span class="required-f">*</span></label>
                                                            <select name="country_id" class="form-control">
                                                                <option value=""> --- Please Select --- </option>
                                                                <option value="1">American Express</option>
                                                                <option value="2">Visa Card</option>
                                                                <option value="3">Master Card</option>
                                                                <option value="4">Discover Card</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                            <label for="input-cardno">Credit Card Number  <span class="required-f">*</span></label>
                                                            <input name="cardno" value="" placeholder="Credit Card Number" id="input-cardno" class="form-control" type="text">
                                                        </div>
                                                        <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                            <label for="input-cvv">CVV Code <span class="required-f">*</span></label>
                                                            <input name="cvv" value="" placeholder="Card Verification Number" id="input-cvv" class="form-control" type="text">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                            <label>Expiration Date <span class="required-f">*</span></label>
                                                            <input type="date" name="exdate" class="form-control">
                                                        </div>
                                                        <div class="form-group col-md-6 col-lg-6 col-xl-6 required">
                                                            <img class="padding-25px-top xs-padding-5px-top" src="assets/images/payment-img.jpg" alt="card" title="card" />
                                                        </div>
                                                    </div>
                                                </fieldset>

                                            </div>
                                        </div>
                                    </div> -->


                                </div>
                            </div>

                            <div class="order-button-payment">
                                <!-- <button  class="btn" value="Place order" type="submit">Place order</button> -->
                                <a  href="/place-order" class="btn" style="background-color: cadetblue;" value="Place order" type="submit">Place order</a>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</div>
<%-include('footer')-%>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const form = document.getElementById("address-form");

        form.addEventListener('submit', function (event) {
            let valid = true;

            // Reset previous error messages
            const errorMessages = form.querySelectorAll('.error');
            errorMessages.forEach(function (error) {
                error.textContent = '';
            });

            // Validate User Name
            const name = form.querySelector('#input-firstname').value.trim();
            if (name === '') {
                valid = false;
                displayError('input-firstname', 'User Name is required.');
            }

            // Validate Email
            const email = form.querySelector("#input-email").value.trim();
            if (email === '') {
                valid = false;
                displayError('input-email', 'Email is required.');
            } else if (!isValidEmail(email)) {
                valid = false;
                displayError('input-email', 'Enter a valid email address.');
            }

            const telephone = form.querySelector("#input-telephone").value.trim();
            if (telephone === '') {
                valid = false;
                displayError('input-telephone', 'Contact number is required.');
            } else if (isNaN(telephone) || telephone.length !== 10) {
                valid = false;
                displayError('input-telephone', 'Enter a valid 10-digit number.');
            }

            const postcode = form.querySelector("#input-postcode").value.trim();
            if (postcode === '') {
                valid = false;
                displayError('input-postcode', 'Postcode is required.');
            } else if (isNaN(postcode) || postcode.length !== 6) {
                valid = false;
                displayError('input-postcode', 'Enter a valid postcode.');
            }

            

            const cityName = form.querySelector('#input-city').value.trim();
            if (cityName === '') {
                valid = false;
                displayError('input-city', 'City is required.');
            }

            const stateName = form.querySelector('#input-state').value.trim();
            if (stateName === '') {
                valid = false;
                displayError('input-state', 'Region/State is required.');
            }

            

            const address = form.querySelector('#input-address-1').value.trim();
            if (address === '') {
                valid = false;
                displayError('input-address-1', 'Address is required.');
            }

            if (!valid) {
                event.preventDefault();
            }
        });

        const isValidEmail = email => {
            const re = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            return re.test(String(email).toLowerCase());
        };

        function displayError(field, message) {
            const errorDiv = form.querySelector(`#${field}`).nextElementSibling;
            errorDiv.textContent = message;
        }
    });
</script>


</body>
</html>
