<%-include('header')-%>


<div id="page-content">
  <!--Collection Banner-->
    <div class="slideshow slideshow-wrapper pb-4">
    <div class="home-slideshow">
        <div class="slide">
            <div class="blur-up lazyload">
                <img class="blur-up lazyload desktop-show" data-src="/assets/images/slideshow-banners/home3-banner.jpg" src="/assets/images/slideshow-banners/home3-banner.jpg" alt="There is Beauty in Simplycity" title="There is Beauty in Simplycity" />
                <img class="blur-up lazyload mobile-show" data-src="/assets/images/slideshow-banners/home3-banner-mobile.jpg" src="/assets/images/slideshow-banners/home3-banner-mobile.jpg" alt="There is Beauty in Simplycity" title="There is Beauty in Simplycity" />
                <div class="slideshow__text-wrap slideshow__overlay classic middle">
                    <div class="slideshow__text-content left">
                        <div class="container">
                            <div class="wrap-caption left">
                                <h2 class="h1 mega-title slideshow__title">There is Beauty in Simplycity</h2>
                                <span class="mega-subtitle slideshow__subtitle">Save up to 50% off this weekend only</span>
                                <span class="btn">Shop now</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
 </div>

    <!--End Collection Banner-->
    <div clets="containe-fluid" >
      <div class="row">
        <!-- <nav class="grid__item" id="AccessibleNav">for mobile -->
            <ul id="siteNav" class="site-nav medium center hidearrow">
                    <li class="lvl1 parent dropdown">
                        <a >price sort
                            <i class="anm anm-angle-down-l"></i>
                        </a>
                        <ul class="dropdown">
                                <li>
                                    <div class="price-filter">
                                        <div id="slider-range" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all">
                                            <div class="ui-slider-range ui-widget-header ui-corner-all">

                                            </div>
                                            <span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span>
                                            <span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span>
                                        </div>
                                        <div class="row">
                                            <div class="col-6">
                                                <p class="no-margin"><input id="amount" name="priceValue" type="text" style="background-color: darkslategray; color: beige;"></p>
                                            </div>
                                            <div class="col-6 text-right margin-20px-top " >
                                                <button class="btn btn-secondary btn--small" id="btn-1"  style="background-color: darkslategray; ">
                                                    <p style="font-size: 11px; color: beige; ">High to Low</p>
                                                </button>
                                                <button class="btn btn-secondary btn--small" id="btn-2"  style="background-color: darkslategray;">
                                                    <p style="font-size: 11px;  color: beige;">Low to High</p>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                        </ul>
                        <li class="lvl1 parent dropdown">
                            <a>Search
                            </a>
                            <ul class="dropdown" style="background-color: rgb(249, 251, 251); width: 150px;">
                                <div class="form-group has-search"  >
                                    <input  class="fa fa-search form-control-feedback" type="text"   value=""  id="search-value"  class="form-control" placeholder="Search" style="border: 0cm; color: rgb(15, 5, 5);">
                                    <button class="btn btn-secondary btn--small"  id="search-btn"  style="background-color: darkslategray;">
                                        <p style="font-size: 11px;  color: beige;">Enter</p>
                                    </button>
                                </div>
                            </ul>
                        </li>              
            </ul>
              <div class="productList product-load-more" >
                    <div class="grid-products grid--view-items">
                        <div class="row" style="display: flex; justify-content: center; align-items: center; overflow: hidden;" id="orginalList">
                            <% product.forEach((product) => { %>
                                <div class="product-item" style="width: 18%; border: 1px solid #ddd; padding: 15px; margin: 1%; text-align: center; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
                                    <div class="product-image mt-2 rounded-top rounded-bottom" style="position: relative; overflow: hidden;">
                            
                                        <!-- Add to Cart button -->

                                        <form class="variants add" action="#" onclick="window.location.href='cart.html'" method="post" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0; transition: opacity 0.3s;">
                                            <button class="btn btn-addto-cart" type="button" style="background-color: #3498db; color: #fff; padding: 8px 16px; border: none; border-radius: 5px; cursor: pointer;">Add to Cart</button>
                                        </form>
                            
                                        <a href="/productdetails/<%=product._id%>" class="product-link">
                                            <!-- Original image -->

                                            <img class="primary lazyload" data-src="<%=product.image[0]%>" src="<%=product.image[0]%>" alt="image" title="product" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; transition: transform 0.3s ease-in-out; opacity: 1;" />
                            
                                            <!-- Hover effect image -->
                            
                                            <!-- Hover effect -->

                                            <div class="overla" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); opacity: 0; transition: opacity 0.3s ease-in-out;">
                                                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #fff;">
                                                    <p style="font-size: 14px;">Add to Cart</p>
                                                </div>
                                            </div>
                                        </a>
                                    </div>
                            
                                    <div class="product-details text-center" style="margin-top: 10px;">

                                        <div>
                                            <button style="background-color: rgba(0, 255, 255, 0.621); color: brown;">add to cart</button>
                            
                                        </div>
                                        <div class="product-name">
                                            <p style="font-weight: bold; font-size: 14px; color: #333; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"><%=product.name%></p>
                                        </div>
                                        <div class="product-price">
                                            <span class="price" style="font-size: 16px; color: #27ae60; font-weight: bold;"><%=product.price%></span>
                                        </div>
                                        <div class="product-review" style="color: #f39c12; margin-top: 5px;">
                                            <i class="font-16 fa fa-star"></i>
                                            <i class="font-16 fa fa-star"></i>
                                            <i class="font-16 fa fa-star"></i>
                                            <i class="font-16 fa fa-star"></i>
                                            <i class="font-16 fa fa-star"></i>
                                        </div>
                                    </div>
                                </div>
                            <% }) %>
                            
                            <style>
                                
                            
                              
                            
                               
                                .product-link {
                                    position: relative;
                                    display: block;
                                }
                            </style>
                            

                            
                        </div>
                    </div>
                </div>
                </div>
                

            <div class="infinitpaginOuter" style="display: flex; justify-content: center;" id="orginalPagination">
                <div class="infinitpagin  ">	
                    <% if (totalPages > 1) { %>
                        <ul class="pagination ">
                            <% for (let i = 1; i <= totalPages; i++) { %>
                                <li class="btn-dark page-item <%= i === currentPage ? 'active' : '' %>"  style="background-color: aliceblue;">
                                    <a class="page-link" style="margin: 2px; "  href="?page=<%= i %>">
                                        <p style="font-size: 15px; color: black;" ><%= i %></p>
                                    </a>
                                </li>
                            <% } %>
                        </ul>
                    <% } %>
                </div>
            </div>

            <!--End Main Content-->
        </div>
    </div>
    
</div>


<!-- EJS script code with corrections -->




<!-- price sorting script -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        
        document.getElementById('btn-1').addEventListener('click', function() {
            const value = document.getElementById('amount').value.trim();
            fetchData('/category/<%=categoryName%>/ascending', value);
        });

        document.getElementById('btn-2').addEventListener('click', function() {
            const value = document.getElementById('amount').value.trim();
            fetchData('/category/<%=categoryName%>/descending', value);
        });

        const fetchData = async (url, value) => {
            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ value }),
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                const {sortedProducts ,totalPages, currentPage} = await response.json();
                const sortedProductsArray = sortedProducts;



                const productListContainer = document.getElementById('orginalList');
                const paginationContainer = document.getElementById('orginalPagination')

                // paginationContainer.innerHTML +='<h1>jhugj</h1>';

                paginationContainer.innerHTML ='';
                // its impossible



                productListContainer.innerHTML = '' ; 


                sortedProductsArray.forEach(product => {
                    productListContainer.innerHTML +=  
                    `   
                <div class="product-item" style="width: 18%; border: 1px solid #ddd; padding: 15px; margin: 1%; text-align: center; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
                <div class="product-image mt-2 rounded-top rounded-bottom" style="position: relative; overflow: hidden;">
            
                    <!-- Add to Cart button -->
                    <form class="variants add" action="#" onclick="window.location.href='cart.html'" method="post" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0; transition: opacity 0.3s;">
                        <button class="btn btn-addto-cart" type="button" style="background-color: #3498db; color: #fff; padding: 8px 16px; border: none; border-radius: 5px; cursor: pointer;">Add to Cart</button>
                    </form>
            
                    <a href="/productdetails/${product._id}">
                        <img class="primary lazyload" data-src="${product.image[0]}" src="${product.image[0]}" alt="image" title="product" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; transition: transform 0.3s ease-in-out; opacity: 1;" />
            
                        <!-- Hover effect -->
                        <div class="overlay" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); opacity: 0; transition: opacity 0.3s ease-in-out;">
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #fff;">
                                <p style="font-size: 14px;">Add to Cart</p>
                            </div>
                        </div>
                    </a>
                </div>
            
                <div class="product-details text-center" style="margin-top: 10px;">
                    <div>
                        <button style="background-color: rgba(0, 255, 255, 0.621); color: brown;">add to cart</button>
                    </div>
                    <div class="product-name">
                        <p style="font-weight: bold; font-size: 14px; color: #333; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${product.name}</p>
                    </div>
                    <div class="product-price">
                        <span class="price" style="font-size: 16px; color: #27ae60; font-weight: bold;">${product.price}</span>
                    </div>
                    <div class="product-review" style="color: #f39c12; margin-top: 5px;">
                        <i class="font-16 fa fa-star"></i>
                        <i class="font-16 fa fa-star"></i>
                        <i class="font-16 fa fa-star"></i>
                        <i class="font-16 fa fa-star"></i>
                        <i class="font-16 fa fa-star"></i>
                    </div>
                </div>
            </div>
            
            <style>
                .product-item:hover .variants.add {
                    opacity: 1;
                }
            
                .product-item:hover .overlay {
                    opacity: 1;
                }
            
                .product-item:hover img:first-child {
                    opacity: 0;
                }
            
                .product-item:hover img:last-child {
                    opacity: 1;
                }
            </style>            
              
                `
                });


                // how its 


                if (totalPages > 1) {
        paginationContainer.innerHTML += `
    <div class="infinitpaginOuter" style="display: flex; justify-content: center;">
        <div class="infinitpagin">	
            ${
                totalPages > 1 ? 
                `<ul class="pagination">
                    ${Array.from({ length: totalPages }, (_, i) => `
                        <li class="btn-dark page-item ${i + 1 === currentPage ? 'active' : ''}" style="background-color: aliceblue;">
                            <a class="page-link" style="margin: 2px;" href="?page=${i + 1}$name='kkk">
                                <p style="font-size: 15px; color: black;">${i + 1}</p>
                            </a>
                        </li>`).join('')
                    }
                </ul>` 
                : ''
            }
        </div>
    </div>
`;
    }
            } catch (error) {
                console.error('Error:', error);
            }
        };
        });
    
</script>








<!-- search filter  by name-->
<script>
    document.addEventListener('DOMContentLoaded', function() {

        const searchInput = document.getElementById('search-value');
        const searchButton = document.getElementById('search-btn');

        searchButton.addEventListener('click', function () {                       
            let searchTerm = searchInput.value.trim();                            
            fetchData('/category/<%=categoryName%>/searchProduct',  {searchTerm });   
        });

        const fetchData = async (url,  searchTerm ) => {

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify( searchTerm ),
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                const searchProducts = await response.json();
                const searchProductsArray = searchProducts.searchProducts;

                const productListContainer = document.getElementById('orginalList');
                productListContainer.innerHTML = ''; // Clear existing content
                const paginationContainer = document.getElementById('orginalPagination')
                paginationContainer.innerHTML = '';
               
                searchProductsArray.forEach(product => {
                    productListContainer.innerHTML +=  
                        `  
                        <div class="product-item" style="width: 18%; border: 1px solid #ddd; padding: 15px; margin: 1%; text-align: center; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
                <div class="product-image mt-2 rounded-top rounded-bottom" style="position: relative; overflow: hidden;">
            
                    <!-- Add to Cart button -->
                    <form class="variants add" action="#" onclick="window.location.href='cart.html'" method="post" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0; transition: opacity 0.3s;">
                        <button class="btn btn-addto-cart" type="button" style="background-color: #3498db; color: #fff; padding: 8px 16px; border: none; border-radius: 5px; cursor: pointer;">Add to Cart</button>
                    </form>
            
                    <a href="/productdetails/${product._id}">
                        <img class="primary lazyload" data-src="${product.image[0]}" src="${product.image[0]}" alt="image" title="product" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; transition: transform 0.3s ease-in-out; opacity: 1;" />
            
                        <!-- Hover effect -->
                        <div class="overlay" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); opacity: 0; transition: opacity 0.3s ease-in-out;">
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #fff;">
                                <p style="font-size: 14px;">Add to Cart</p>
                            </div>
                        </div>
                    </a>
                </div>
            
                <div class="product-details text-center" style="margin-top: 10px;">
                    <div>
                        <button style="background-color: rgba(0, 255, 255, 0.621); color: brown;">add to cart</button>
                    </div>
                    <div class="product-name">
                        <p style="font-weight: bold; font-size: 14px; color: #333; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${product.name}</p>
                    </div>
                    <div class="product-price">
                        <span class="price" style="font-size: 16px; color: #27ae60; font-weight: bold;">${product.price}</span>
                    </div>
                    <div class="product-review" style="color: #f39c12; margin-top: 5px;">
                        <i class="font-16 fa fa-star"></i>
                        <i class="font-16 fa fa-star"></i>
                        <i class="font-16 fa fa-star"></i>
                        <i class="font-16 fa fa-star"></i>
                        <i class="font-16 fa fa-star"></i>
                    </div>
                </div>
            </div>
            
            <style>
                .product-item:hover .variants.add {
                    opacity: 1;
                }
            
                .product-item:hover .overlay {
                    opacity: 1;
                }
            
                .product-item:hover img:first-child {
                    opacity: 0;
                }
            
                .product-item:hover img:last-child {
                    opacity: 1;
                }
            </style>  
                    
                    `
                });

            } catch (error) {
                console.error('Error:', error);
            }

        };
    });
</script>




<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<%-include('footer')-%>
    </body>
    </html>